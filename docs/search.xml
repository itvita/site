<?xml version="1.0" encoding="utf-8"?>
<search>
  <entry>
    <title>AOP统数据库统一字段处理</title>
    <url>/20221127/AOP%E7%BB%9F%E6%95%B0%E6%8D%AE%E5%BA%93%E7%BB%9F%E4%B8%80%E5%AD%97%E6%AE%B5%E5%A4%84%E7%90%86/</url>
    <content><![CDATA[<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.itvita.norisk.company.config;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.itvita.norisk.company.model.dto.CmpUserDto;</span><br><span class="line"><span class="keyword">import</span> com.itvita.norisk.company.util.SystemUtil;</span><br><span class="line"><span class="keyword">import</span> org.aspectj.lang.ProceedingJoinPoint;</span><br><span class="line"><span class="keyword">import</span> org.aspectj.lang.annotation.Around;</span><br><span class="line"><span class="keyword">import</span> org.aspectj.lang.annotation.Aspect;</span><br><span class="line"><span class="keyword">import</span> org.aspectj.lang.annotation.Pointcut;</span><br><span class="line"><span class="keyword">import</span> org.springframework.beans.BeanWrapper;</span><br><span class="line"><span class="keyword">import</span> org.springframework.beans.BeanWrapperImpl;</span><br><span class="line"><span class="keyword">import</span> org.springframework.context.annotation.Configuration;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.time.LocalDateTime;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Time</span>: 2021/5/27 11:16</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span>: liu.q [916000612@qq.com]</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@des</span>:  统一处理公共数据库字段</span></span><br><span class="line"><span class="comment"> * */</span></span><br><span class="line"><span class="meta">@Aspect</span></span><br><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">SqlAopConfig</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Pointcut(&quot;execution(* com.itvita.norisk.company.mapper.*.insert(..))&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">excudeAddService</span><span class="params">()</span> &#123;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Pointcut(&quot;execution(* com.itvita.norisk.company.mapper.*.updateById(..))&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">excudeUpdateService</span><span class="params">()</span> &#123;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Around(&quot;excudeAddService()&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> Object <span class="title function_">addAround</span><span class="params">(ProceedingJoinPoint thisJoinPoint)</span> &#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            Object[] args = thisJoinPoint.getArgs();</span><br><span class="line">            <span class="comment">// myBatis只能传递一个参数</span></span><br><span class="line">            <span class="keyword">if</span> (args != <span class="literal">null</span> &amp;&amp; args.length &gt; <span class="number">0</span>) &#123;</span><br><span class="line">                <span class="type">Object</span> <span class="variable">argument</span> <span class="operator">=</span> args[<span class="number">0</span>];</span><br><span class="line">                <span class="type">BeanWrapper</span> <span class="variable">beanWrapper</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">BeanWrapperImpl</span>(argument);</span><br><span class="line">                <span class="type">CmpUserDto</span> <span class="variable">cmpUserDto</span> <span class="operator">=</span> SystemUtil.getCmpUserDto();</span><br><span class="line">                beanWrapper.setPropertyValue(<span class="string">&quot;createdBy&quot;</span>, cmpUserDto.getId());</span><br><span class="line">                beanWrapper.setPropertyValue(<span class="string">&quot;createdName&quot;</span>, cmpUserDto.getNickName());</span><br><span class="line">                beanWrapper.setPropertyValue(<span class="string">&quot;createdTime&quot;</span>, LocalDateTime.now());</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">return</span> thisJoinPoint.proceed(args);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (Throwable e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Around(&quot;excudeUpdateService()&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> Object <span class="title function_">UpdAround</span><span class="params">(ProceedingJoinPoint thisJoinPoint)</span> &#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            Object[] args = thisJoinPoint.getArgs();</span><br><span class="line">            <span class="comment">// myBatis只能传递一个参数</span></span><br><span class="line">            <span class="keyword">if</span> (args != <span class="literal">null</span> &amp;&amp; args.length &gt; <span class="number">0</span>) &#123;</span><br><span class="line">                <span class="type">Object</span> <span class="variable">argument</span> <span class="operator">=</span> args[<span class="number">0</span>];</span><br><span class="line">                <span class="type">BeanWrapper</span> <span class="variable">beanWrapper</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">BeanWrapperImpl</span>(argument);</span><br><span class="line">                <span class="type">CmpUserDto</span> <span class="variable">cmpUserDto</span> <span class="operator">=</span> SystemUtil.getCmpUserDto();</span><br><span class="line">                beanWrapper.setPropertyValue(<span class="string">&quot;updatedBy&quot;</span>, cmpUserDto.getId());</span><br><span class="line">                beanWrapper.setPropertyValue(<span class="string">&quot;updatedName&quot;</span>, cmpUserDto.getNickName());</span><br><span class="line">                beanWrapper.setPropertyValue(<span class="string">&quot;updatedTime&quot;</span>, LocalDateTime.now());</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">return</span> thisJoinPoint.proceed(args);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (Throwable e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>]]></content>
      <categories>
        <category>springboot</category>
      </categories>
      <tags>
        <tag>aop</tag>
      </tags>
  </entry>
  <entry>
    <title>mac配置多jdk随意切换</title>
    <url>/20221127/mac%E9%85%8D%E7%BD%AE%E5%A4%9Ajdk%E9%9A%8F%E6%84%8F%E5%88%87%E6%8D%A2/</url>
    <content><![CDATA[<h1 id="下载安装"><a href="#下载安装" class="headerlink" title="下载安装"></a>下载安装</h1><p><a href="https://support.apple.com/kb/DL1572?locale=zh_CN">JDK6</a><br><a href="">JDK7</a><br><a href="">JDK8</a></p>
<h1 id="配置环境变量"><a href="#配置环境变量" class="headerlink" title="配置环境变量"></a>配置环境变量</h1><figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">open .bash_profile</span><br><span class="line"></span><br><span class="line"><span class="built_in">export</span> PATH=<span class="variable">$PATH</span>:/usr/local/apache-tomcat-7.0.79/bin</span><br><span class="line"><span class="built_in">export</span> JAVA_6_HOME=/Library/Java/JavaVirtualMachines/1.6.0.jdk/Contents/Home</span><br><span class="line"><span class="built_in">export</span> JAVA_7_HOME=/Library/Java/JavaVirtualMachines/jdk1.7.0_79.jdk/Contents/Home</span><br><span class="line"><span class="built_in">export</span> JAVA_8_HOME=/Library/Java/JavaVirtualMachines/jdk1.8.0_131.jdk/Contents/Home</span><br></pre></td></tr></table></figure>

<h1 id="设置默认的jdk版本"><a href="#设置默认的jdk版本" class="headerlink" title="设置默认的jdk版本"></a>设置默认的jdk版本</h1><figure class="highlight sh"><table><tr><td class="code"><pre><span class="line"><span class="built_in">export</span> JAVA_HOME=<span class="variable">$JAVA_8_HOME</span> </span><br></pre></td></tr></table></figure>

<h1 id="设置alias-用于切换"><a href="#设置alias-用于切换" class="headerlink" title="设置alias 用于切换"></a>设置alias 用于切换</h1><figure class="highlight sh"><table><tr><td class="code"><pre><span class="line"><span class="built_in">alias</span> jdk8=<span class="string">&#x27;export JAVA_HOME=$JAVA_8_HOME&#x27;</span></span><br><span class="line"><span class="built_in">alias</span> jdk7=<span class="string">&#x27;export JAVA_HOME=$JAVA_7_HOME&#x27;</span></span><br><span class="line"><span class="built_in">alias</span> jdk6=<span class="string">&#x27;export JAVA_HOME=$JAVA_6_HOME&#x27;</span></span><br></pre></td></tr></table></figure>

<h1 id="保存退出后刷新配置"><a href="#保存退出后刷新配置" class="headerlink" title="保存退出后刷新配置"></a>保存退出后刷新配置</h1><figure class="highlight sh"><table><tr><td class="code"><pre><span class="line"><span class="built_in">source</span> .bash_profile</span><br></pre></td></tr></table></figure>

<h1 id="切换jdk"><a href="#切换jdk" class="headerlink" title="切换jdk"></a>切换jdk</h1><figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">命令行输入jdk6，再输入java -version 查看当前版本即可实现动态切换，jdk7，jdk8同样。</span><br></pre></td></tr></table></figure>
]]></content>
      <categories>
        <category>java</category>
      </categories>
      <tags>
        <tag>mac</tag>
        <tag>jdk</tag>
      </tags>
  </entry>
</search>
